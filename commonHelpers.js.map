{"version":3,"file":"commonHelpers.js","sources":["../src/js/gallary-api.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\r\n\r\nexport async function fetchImages(query, page) {\r\n  const apiKey = '40924085-809e05b3e969373237b06a228';\r\n  const url = `https://pixabay.com/api/?key=${apiKey}&q=${encodeURIComponent(\r\n    query\r\n  )}&image_type=photo&orientation=horizontal&safesearch=true&per_page=40&page=${page}`;\r\n  const { data } = await axios.get(url);\r\n  return data;\r\n}\r\n","import { fetchImages } from './js/gallary-api';\r\nimport iziToast from 'izitoast';\r\nimport 'izitoast/dist/css/iziToast.min.css';\r\nimport SimpleLightbox from 'simplelightbox';\r\nimport 'simplelightbox/dist/simple-lightbox.min.css';\r\n\r\nlet currentPage = 1;\r\nlet currentQuery = '';\r\nlet isLoading = false;\r\nlet totalHits = 0;\r\nlet isSearchPerformed = false;\r\n\r\nconst container = document.getElementById('images-container');\r\n\r\nlet gallery = new SimpleLightbox('.gallery a');\r\n\r\nconst endOfListMsg = document.querySelector('.end-message');\r\nendOfListMsg.classList.add('none');\r\ndocument\r\n  .getElementById('search-form')\r\n  .addEventListener('submit', async event => {\r\n    event.preventDefault();\r\n    const query = event.target.elements.searchQuery.value.trim();\r\n    if (!query) {\r\n      iziToast.warning({\r\n        message: 'Please fill in the search field to find images.',\r\n        position: 'topRight',\r\n      });\r\n      return;\r\n    }\r\n    currentQuery = query;\r\n    currentPage = 1;\r\n\r\n    try {\r\n      isLoading = true;\r\n      const images = await fetchImages(currentQuery, currentPage);\r\n      isLoading = false;\r\n      isSearchPerformed = true;\r\n      totalHits = images.totalHits;\r\n\r\n      if (totalHits <= 0) {\r\n        container.innerHTML = '';\r\n        iziToast.error({\r\n          message:\r\n            'Sorry, there are no images matching your search query. Please try again.',\r\n          position: 'topRight',\r\n        });\r\n        return;\r\n      }\r\n\r\n      // if (images.hits.length > 0) {\r\n      displayImages(images.hits, true);\r\n      iziToast.success({\r\n        message: `Hooray! We found ${totalHits} images.`,\r\n        position: 'topRight',\r\n      });\r\n      // } else {\r\n      //   const container = document.getElementById('images-container');\r\n      //   container.innerHTML = '';\r\n      //   gallery = new SimpleLightbox('.gallery a', {\r\n      //     captionType: 'data',\r\n      //     captionDelay: 250,\r\n      //   });\r\n      //   iziToast.error({\r\n      //     message:\r\n      //       'Sorry, there are no images matching your search query. Please try again.',\r\n      //     position: 'topRight',\r\n      //   });\r\n      // }\r\n    } catch (error) {\r\n      isLoading = false;\r\n      console.error('Error during fetch operation:', error);\r\n      iziToast.error({\r\n        message: 'An error occurred while fetching images.',\r\n        position: 'topRight',\r\n      });\r\n    }\r\n\r\n    event.target.elements.searchQuery.value = '';\r\n  });\r\n\r\nfunction displayImages(images, clear) {\r\n  const container = document.getElementById('images-container');\r\n  if (clear) {\r\n    container.innerHTML = '';\r\n    gallery = new SimpleLightbox('.gallery a', {\r\n      captionType: 'data',\r\n      captionDelay: 250,\r\n    });\r\n  }\r\n  images.forEach(image => {\r\n    container.insertAdjacentHTML(\r\n      'beforeend',\r\n      `<div class=\"image-item\">\r\n      <a href=\"${image.largeImageURL}\"><img class=\"card\" src=\"${image.webformatURL}\" alt=\"${image.tags}\" data-title=\"${image.tags}\"/></a>\r\n      <div class=\"text-container\">\r\n        <p class=\"text\">\r\n          <span class=\"text-decoration\">Likes</span>\r\n          <span class=\"text-decor\">${image.likes}</span>\r\n        </p>\r\n        <p class=\"text\">\r\n          <span class=\"text-decoration\">Views</span>\r\n          <span class=\"text-decor\">${image.views}</span>\r\n        </p>\r\n        <p class=\"text\">\r\n          <span class=\"text-decoration\">Comments</span>\r\n          <span class=\"text-decor\">${image.comments}</span>\r\n        </p>\r\n        <p class=\"text\">\r\n          <span class=\"text-decoration\">Downloads</span>\r\n          <span class=\"text-decor\">${image.downloads}</span>\r\n        </p>\r\n      </div>\r\n    </div>`\r\n    );\r\n  });\r\n\r\n  gallery.refresh();\r\n}\r\n\r\n// ---------skroll\r\n\r\nconst observer = new IntersectionObserver(\r\n  (entries, observer) => {\r\n    if (entries[0].isIntersecting && !isLoading) {\r\n      if (totalHits > currentPage * 40) {\r\n        currentPage++;\r\n        fetchImages(currentQuery, currentPage).then(data => {\r\n          displayImages(data.hits, false);\r\n        });\r\n      } else if (\r\n        totalHits <= currentPage * 40 &&\r\n        totalHits > 0 &&\r\n        isSearchPerformed\r\n      ) {\r\n        endOfListMsg.classList.remove('none');\r\n      }\r\n    }\r\n  },\r\n  { rootMargin: '50px' }\r\n);\r\n\r\nobserver.observe(document.querySelector('.loading-observer'));\r\n"],"names":["fetchImages","query","page","url","data","axios","currentPage","currentQuery","isLoading","totalHits","isSearchPerformed","container","gallery","SimpleLightbox","endOfListMsg","event","iziToast","images","displayImages","error","clear","image","observer","entries"],"mappings":"owBAEO,eAAeA,EAAYC,EAAOC,EAAM,CAE7C,MAAMC,EAAM,qEAA4C,mBACtDF,CACJ,8EAAgFC,IACxE,CAAE,KAAAE,CAAI,EAAK,MAAMC,EAAM,IAAIF,CAAG,EACpC,OAAOC,CACT,CCHA,IAAIE,EAAc,EACdC,EAAe,GACfC,EAAY,GACZC,EAAY,EACZC,EAAoB,GAExB,MAAMC,EAAY,SAAS,eAAe,kBAAkB,EAE5D,IAAIC,EAAU,IAAIC,EAAe,YAAY,EAE7C,MAAMC,EAAe,SAAS,cAAc,cAAc,EAC1DA,EAAa,UAAU,IAAI,MAAM,EACjC,SACG,eAAe,aAAa,EAC5B,iBAAiB,SAAU,MAAMC,GAAS,CACzCA,EAAM,eAAc,EACpB,MAAMd,EAAQc,EAAM,OAAO,SAAS,YAAY,MAAM,OACtD,GAAI,CAACd,EAAO,CACVe,EAAS,QAAQ,CACf,QAAS,kDACT,SAAU,UAClB,CAAO,EACD,MACD,CACDT,EAAeN,EACfK,EAAc,EAEd,GAAI,CACFE,EAAY,GACZ,MAAMS,EAAS,MAAMjB,EAAYO,EAAcD,CAAW,EAK1D,GAJAE,EAAY,GACZE,EAAoB,GACpBD,EAAYQ,EAAO,UAEfR,GAAa,EAAG,CAClBE,EAAU,UAAY,GACtBK,EAAS,MAAM,CACb,QACE,2EACF,SAAU,UACpB,CAAS,EACD,MACD,CAGDE,EAAcD,EAAO,KAAM,EAAI,EAC/BD,EAAS,QAAQ,CACf,QAAS,oBAAoBP,YAC7B,SAAU,UAClB,CAAO,CAcF,OAAQU,EAAP,CACAX,EAAY,GACZ,QAAQ,MAAM,gCAAiCW,CAAK,EACpDH,EAAS,MAAM,CACb,QAAS,2CACT,SAAU,UAClB,CAAO,CACF,CAEDD,EAAM,OAAO,SAAS,YAAY,MAAQ,EAC9C,CAAG,EAEH,SAASG,EAAcD,EAAQG,EAAO,CACpC,MAAMT,EAAY,SAAS,eAAe,kBAAkB,EACxDS,IACFT,EAAU,UAAY,GACtBC,EAAU,IAAIC,EAAe,aAAc,CACzC,YAAa,OACb,aAAc,GACpB,CAAK,GAEHI,EAAO,QAAQI,GAAS,CACtBV,EAAU,mBACR,YACA;AAAA,iBACWU,EAAM,yCAAyCA,EAAM,sBAAsBA,EAAM,qBAAqBA,EAAM;AAAA;AAAA;AAAA;AAAA,qCAIxFA,EAAM;AAAA;AAAA;AAAA;AAAA,qCAINA,EAAM;AAAA;AAAA;AAAA;AAAA,qCAINA,EAAM;AAAA;AAAA;AAAA;AAAA,qCAINA,EAAM;AAAA;AAAA;AAAA,WAI3C,CACA,CAAG,EAEDT,EAAQ,QAAO,CACjB,CAIA,MAAMU,EAAW,IAAI,qBACnB,CAACC,EAASD,IAAa,CACjBC,EAAQ,GAAG,gBAAkB,CAACf,IAC5BC,EAAYH,EAAc,IAC5BA,IACAN,EAAYO,EAAcD,CAAW,EAAE,KAAKF,GAAQ,CAClDc,EAAcd,EAAK,KAAM,EAAK,CACxC,CAAS,GAEDK,GAAaH,EAAc,IAC3BG,EAAY,GACZC,GAEAI,EAAa,UAAU,OAAO,MAAM,EAGzC,EACD,CAAE,WAAY,MAAQ,CACxB,EAEAQ,EAAS,QAAQ,SAAS,cAAc,mBAAmB,CAAC"}